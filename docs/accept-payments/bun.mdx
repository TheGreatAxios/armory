---
description: Accept Armory payments in Bun
---

# Accept Payments with Bun

Accept Armory payments in your Bun HTTP server using the middleware.

## Basic Setup

```typescript
import { acceptPaymentsViaArmory } from '@armory-sh/middleware';

const middleware = acceptPaymentsViaArmory({
  payTo: '0xYourWalletAddress...',
  amount: '1.0'
});

Bun.serve({
  port: 3000,
  fetch: (req) => {
    const payment = middleware(req);

    if (!payment.valid) {
      return new Response('Payment required', {
        status: 402,
        headers: payment.headers
      });
    }

    return new Response(JSON.stringify({ data: [...] }));
  }
});
```

## Multi-Network/Multi-Token

```typescript
const middleware = acceptPaymentsViaArmory({
  payTo: '0xYourWalletAddress...',
  amount: '1.0',
  accept: {
    networks: ['base', 'ethereum', 'polygon'],
    tokens: ['usdc', 'usdt'],
    facilitators: [
      { url: 'https://facilitator1.com' },
      { url: 'https://facilitator2.com' }
    ]
  }
});
```

## Multi-Pricing

Charge different amounts based on network, token, or facilitator:

```typescript
const middleware = acceptPaymentsViaArmory({
  payTo: '0xYourWalletAddress...',
  amount: '10.0', // default fallback
  pricing: [
    { network: 'ethereum', token: 'usdc', amount: '12.0' },
    { network: 'base', token: 'usdt', amount: '9.50' },
    { network: 'base', token: 'usdc', facilitator: 'https://special-facilitator.com', amount: '8.0' },
    { network: 'ethereum', amount: '15.0' }
  ],
  accept: {
    networks: ['base', 'ethereum'],
    tokens: ['usdc', 'usdt'],
    facilitators: [
      { url: 'https://facilitator1.com' },
      { url: 'https://special-facilitator.com' }
    ]
  }
});
```

